<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>포인트 관리 시스템</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-top">
                <div class="header-content">
                    <h1><i class="fas fa-coins"></i> 포인트 관리</h1>
                    <p>포인트 적립과 사용을 체계적으로 관리하세요</p>
                </div>
                <div class="header-actions">
                    <!-- 로그인하지 않은 상태 -->
                    <div id="guestActions" class="auth-actions">
                        <button id="loginBtn" class="login-btn">
                            <i class="fas fa-sign-in-alt"></i> 로그인
                        </button>
                    </div>
                    
                    <!-- 로그인된 상태 -->
                    <div id="userActions" class="auth-actions hidden">
                        <div class="user-info">
                            <span class="username" id="headerUsername">사용자</span>
                            <span class="user-points" id="headerUserPoints">0P</span>
                        </div>
                        <button id="logoutBtn" class="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> 로그아웃
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="main-content">
            <!-- 맨 왼쪽 컬럼: 모든 사용자 포인트 현황 & 잭팟 시스템 -->
            <div class="users-points-column">
                <div class="users-points-section">
                    <h3 class="section-title">
                        <i class="fas fa-users"></i> 모든 사용자 포인트
                    </h3>
                    <div class="table-container">
                        <table id="usersPointsTable">
                            <thead>
                                <tr>
                                    <th>사용자</th>
                                    <th>포인트</th>
                                </tr>
                            </thead>
                            <tbody id="usersPointsTableBody">
                                <!-- 사용자 포인트 목록이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="jackpot-section" class="jackpot-section closable-section">
                    <h3 class="section-title">
                        <i class="fas fa-trophy"></i> 잭팟 시스템
                        <button class="toggle-section-btn" data-section="jackpot-section"><i class="fas fa-eye-slash"></i></button>
                    </h3>
                    <div class="jackpot-display">
                        <h4>현재 잭팟</h4>
                        <p id="jackpotAmount">0P</p>
                        <small>참가비: 101P (1P는 은행 수익으로)</small>
                    </div>
                    <div class="jackpot-scroller-container">
                        <div class="jackpot-scroller" id="scroller1"></div>
                        <div class="jackpot-scroller" id="scroller2"></div>
                        <div class="jackpot-scroller" id="scroller3"></div>
                    </div>
                    <button id="tryJackpotBtn" class="try-jackpot-btn">
                        <i class="fas fa-dice-d6"></i> 잭팟 도전!
                    </button>
                    <div class="jackpot-winners">
                        <h4 class="history-title">
                            <i class="fas fa-star"></i> 최근 잭팟 당첨자
                        </h4>
                        <div class="winners-list" id="jackpotWinnersList">
                            <!-- 잭팟 당첨자 목록이 여기에 동적으로 추가됩니다 -->
                        </div>
                    </div>
                    <div class="closed-message">다음에 올게유~</div>
                </div>

                <div id="gambling-section" class="gambling-section closable-section">
                    <h3 class="section-title">
                        <i class="fas fa-balance-scale"></i> 확률 도박기
                        <button class="toggle-section-btn" data-section="gambling-section"><i class="fas fa-eye-slash"></i></button>
                    </h3>
                    <div class="multiplier-options">
                        <button class="multiplier-btn active" data-multiplier="2" data-prob="50">2배 (50%)</button>
                        <button class="multiplier-btn" data-multiplier="3" data-prob="33">3배 (33%)</button>
                        <button class="multiplier-btn" data-multiplier="5" data-prob="20">5배 (20%)</button>
                        <button class="multiplier-btn" data-multiplier="10" data-prob="10">10배 (10%)</button>
                        <button class="multiplier-btn" data-multiplier="15" data-prob="7">15배 (7%)</button>
                    </div>
                    <div class="bet-controls">
                        <h4>베팅 금액</h4>
                        <div class="bet-amount-control">
                            <button id="decreaseBetBtn" class="bet-adjust-btn">-</button>
                            <span id="betAmountDisplay">100</span>P
                            <button id="increaseBetBtn" class="bet-adjust-btn">+</button>
                        </div>
                        <small>수수료: 베팅 금액 100P당 1P</small>
                    </div>
                    <button id="placeBetBtn" class="place-bet-btn">
                        <i class="fas fa-dice"></i> 베팅하기!
                    </button>
                    <div class="closed-message">다음에 올게유~</div>
                </div>

                <div id="basic-gambling-section" class="gambling-section closable-section">
                    <h3 class="section-title">
                        <i class="fas fa-balance-scale"></i> 기본 확률 도박기
                        <button class="toggle-section-btn" data-section="basic-gambling-section"><i class="fas fa-eye-slash"></i></button>
                    </h3>
                    <div class="multiplier-options">
                        <button class="multiplier-btn active" data-multiplier="2" data-prob="45">2배 (45%)</button>
                        <button class="multiplier-btn" data-multiplier="3" data-prob="30">3배 (30%)</button>
                        <button class="multiplier-btn" data-multiplier="5" data-prob="18">5배 (18%)</button>
                        <button class="multiplier-btn" data-multiplier="10" data-prob="9">10배 (9%)</button>
                        <button class="multiplier-btn" data-multiplier="15" data-prob="6">15배 (6%)</button>
                    </div>
                    <div class="bet-controls">
                        <h4>베팅 금액</h4>
                        <div class="bet-amount-control">
                            <button id="basic-decreaseBetBtn" class="bet-adjust-btn">-</button>
                            <span id="basic-betAmountDisplay">100</span>P
                            <button id="basic-increaseBetBtn" class="bet-adjust-btn">+</button>
                        </div>
                        <small>수수료: 베팅 금액 100P당 1P</small>
                    </div>
                    <button id="basic-placeBetBtn" class="place-bet-btn">
                        <i class="fas fa-dice"></i> 베팅하기!
                    </button>
                    <div class="closed-message">다음에 올게유~</div>
                </div>
            </div>
            
            <!-- 중앙 컬럼: 포인트 관리 -->
            <div class="center-column">
                <div class="balance-section">
                    <div class="balance-card">
                        <div class="balance-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="balance-info">
                            <h2>현재 포인트</h2>
                            <div class="balance-amount" id="currentBalance">0</div>
                            <span class="balance-unit">P</span>
                        </div>
                    </div>
                </div>

                <div class="self-study-section">
                    <h3 class="section-title"><i class="fas fa-book-reader"></i> 야간 자율 학습 포인트</h3>
                    <div class="day-selector">
                        <button class="day-btn" data-day="월">월</button>
                        <button class="day-btn" data-day="화">화</button>
                        <button class="day-btn" data-day="수">수</button>
                        <button class="day-btn" data-day="목">목</button>
                        <button class="day-btn" data-day="금">금</button>
                        <button id="earnSelfStudyBtn" class="earn-study-btn"><i class="fas fa-plus-circle"></i> 적립</button>
                    </div>
                </div>
                
                <div class="input-section">
                    <div class="input-tabs">
                        <button class="tab-btn active" data-tab="earn">
                            <i class="fas fa-plus-circle"></i> 포인트 적립
                        </button>
                        <button class="tab-btn" data-tab="spend">
                            <i class="fas fa-minus-circle"></i> 포인트 사용
                        </button>
                    </div>
                    
                    <div class="input-form" id="earnForm">
                        <div class="form-group">
                            <label for="earnReason">적립 사유</label>
                            <input type="text" id="earnReason" placeholder="예: 헌혈 참여, 봉사상 받음, 친구의 청소 도와주기 등" maxlength="100">
                        </div>
                        <div class="form-group">
                            <label for="earnAmount">적립 포인트</label>
                            <input type="number" id="earnAmount" placeholder="적립할 포인트를 입력하세요" min="1" max="999999">
                        </div>
                        <button id="addEarnBtn" class="submit-btn earn-btn">
                            <i class="fas fa-plus"></i> 적립하기
                        </button>
                    </div>
                    
                    <div class="input-form hidden" id="spendForm">
                        <div class="form-group">
                            <label for="spendAmount">사용 포인트</label>
                            <input type="number" id="spendAmount" placeholder="사용할 포인트를 입력하세요" min="1" max="999999">
                        </div>
                        <div class="form-group">
                            <label for="spendReason">사용 사유</label>
                            <input type="text" id="spendReason" placeholder="예: 상품 구매, 서비스 이용, 선물하기 등" maxlength="100">
                        </div>
                        <button id="addSpendBtn" class="submit-btn spend-btn">
                            <i class="fas fa-minus"></i> 사용하기
                        </button>
                    </div>
                </div>

                <div class="send-money-section">
                    <h3 class="section-title">
                        <i class="fas fa-paper-plane"></i> 친구에게 송금
                    </h3>
                    <div class="form-group">
                        <label for="recipientUsername">받는 사람</label>
                        <input type="text" id="recipientUsername" placeholder="받는 사람의 닉네임을 입력하세요">
                    </div>
                    <div class="form-group">
                        <label for="sendAmount">송금 포인트</label>
                        <input type="number" id="sendAmount" placeholder="송금할 포인트를 입력하세요" min="1">
                    </div>
                    <button id="sendMoneyBtn" class="submit-btn">
                        <i class="fas fa-paper-plane"></i> 송금하기
                    </button>
                </div>

                <div class="loan-section">
                    <h3 class="section-title"><i class="fas fa-hand-holding-usd"></i> 포인트 대출 시스템</h3>
                    <div class="loan-options">
                        <button class="loan-option-btn" data-loan-type="일반 대출">
                            <i class="fas fa-user-check"></i> 일반 대출
                        </button>
                        <button class="loan-option-btn" data-loan-type="사회적 가치 우대 대출">
                            <i class="fas fa-hands-helping"></i> 사회적 가치 우대 대출
                        </button>
                        <button class="loan-option-btn" data-loan-type="테스트용 대출">
                            <i class="fas fa-vial"></i> 테스트용 대출
                        </button>
                        
                    </div>
                    <div class="debt-display">
                        <h4>총 대출금</h4>
                        <p id="totalDebtAmount">0P</p>
                        <small>대출 종류에 따라 이자율이 다르게 적용됩니다.</small>
                    </div>
                    <div class="loan-form hidden" id="loanForm">
                        <h4 id="loanTypeTitle"></h4>
                        <div class="form-group">
                            <label for="loanAmount">대출 포인트</label>
                            <input type="number" id="loanAmount" placeholder="대출할 포인트를 입력하세요" min="1" max="100000">
                        </div>
                        <div class="form-group hidden" id="loanReasonGroup">
                            <label for="loanReason">대출 사유</label>
                            <input type="text" id="loanReason" placeholder="사회적 가치 활동 계획을 입력하세요" maxlength="100">
                        </div>
                        <div class="form-group hidden" id="loanInterestGroup">
                            <label for="loanInterestAmount">지불할 이자</label>
                            <input type="number" id="loanInterestAmount" placeholder="지불할 이자 금액을 입력하세요" min="0">
                        </div>
                        <button id="requestLoanBtn" class="submit-btn">
                            <i class="fas fa-hand-holding-usd"></i> 대출 신청
                        </button>
                    </div>
                </div>

                <div class="loan-status-section">
                    <h3 class="section-title"><i class="fas fa-file-invoice-dollar"></i> 대출 현황</h3>
                    <div class="table-container">
                        <table id="loanStatusTable">
                            <thead>
                                <tr>
                                    <th>종류</th>
                                    <th>대출 원금</th>
                                    <th>총 상환금</th>
                                    <th>주간 이자 (다음 적용일)</th>
                                    <th>상환</th>
                                </tr>
                            </thead>
                            <tbody id="loanStatusBody">
                                <!-- 대출 내역이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="all-users-loan-status-section">
                    <h3 class="section-title">
                        <i class="fas fa-users-cog"></i> 모든 사용자의 대출 현황
                    </h3>
                    <div class="table-container">
                        <table id="allUsersLoanStatusTable">
                            <thead>
                                <tr>
                                    <th>사용자</th>
                                    <th>종류</th>
                                    <th>대출 원금</th>
                                    <th>총 상환금</th>
                                    <th>주간 이자</th>
                                    <th>상환</th>
                                </tr>
                            </thead>
                            <tbody id="allUsersLoanStatusTableBody">
                                <!-- 모든 사용자의 대출 내역이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="loan-limit-section">
                    <h3 class="section-title"><i class="fas fa-user-shield"></i> 사용자별 대출 한도</h3>
                    <div class="table-container">
                        <table id="loanLimitTable">
                            <thead>
                                <tr>
                                    <th>사용자</th>
                                    <th>대출 한도</th>
                                    <th>관리</th>
                                </tr>
                            </thead>
                            <tbody id="loanLimitTableBody">
                                <!-- 대출 한도 내역이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="memo-section">
                    <h3 class="section-title">
                        <i class="fas fa-bullhorn"></i> 공지사항 및 사용/적립 포인트 금액표
                        <button id="editMemoBtn" class="edit-btn" title="메모 수정"><i class="fas fa-edit"></i></button>
                    </h3>
                    <div id="memo-content" class="memo-content">
                        <p>여기에 공지사항을 입력하세요.</p>
                    </div>
                </div>
                
                <div class="stats-section">
                    <div class="stat-item">
                        <span class="stat-number" id="totalEarned">0</span>
                        <span class="stat-label">총 적립</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalSpent">0</span>
                        <span class="stat-label">총 사용</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="transactionCount">0</span>
                        <span class="stat-label">거래 횟수</span>
                    </div>
                </div>
                
                <div class="filters">
                    <button class="filter-btn active" data-filter="all">전체</button>
                    <button class="filter-btn" data-filter="earn">적립</button>
                    <button class="filter-btn" data-filter="spend">사용</button>
                </div>
                
                <div class="transactions-container">
                    <h3 class="section-title">거래 내역</h3>
                    <div class="transactions-list" id="transactionsList">
                        <!-- 거래 내역이 여기에 동적으로 추가됩니다 -->
                    </div>
                </div>
                
                <div class="empty-state" id="emptyState">
                    <i class="fas fa-receipt"></i>
                    <h3>거래 내역이 없습니다</h3>
                    <p>첫 번째 포인트 거래를 시작해보세요!</p>
                </div>
            </div>
            
            <!-- 오른쪽 컬럼 -->
            <div class="right-column">
                <div class="new-activity-log-section">
                    <h3 class="section-title section-title-with-button">
                        <span><i class="fas fa-satellite-dish"></i> 신규 실시간 로그</span>
                        <button id="clearLogBtn" class="clear-log-btn" title="로그 초기화"><i class="fas fa-eraser"></i></button>
                    </h3>
                    <div class="new-activity-feed" id="newActivityFeed">
                        <!-- 신규 실시간 활동 로그가 여기에 동적으로 추가됩니다 -->
                    </div>
                    <div class="empty-new-activity" id="emptyNewActivity">
                        <i class="fas fa-comment-slash"></i>
                        <h4>아직 활동이 없습니다</h4>
                    </div>
                </div>

                <div class="gambler-ranking-section">
                    <h3 class="section-title">
                        <i class="fas fa-crown"></i> 도박자 랭킹
                        <button id="resetRankingBtn" class="edit-btn" title="랭킹 초기화"><i class="fas fa-trash-alt"></i></button>
                    </h3>
                    <div class="table-container">
                        <table id="gamblerRankingTable">
                            <thead>
                                <tr>
                                    <th>순위</th>
                                    <th>사용자</th>
                                    <th>총 베팅액</th>
                                    <th>베팅 횟수</th>
                                </tr>
                            </thead>
                            <tbody id="gamblerRankingTableBody">
                                <!-- 랭킹 내역이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="activity-log-section">
                    <h3 class="section-title">
                        <i class="fas fa-comments"></i> 실시간 활동 로그
                    </h3>
                    
                    <div class="log-info">
                        <span class="online-users" id="onlineUsers">온라인: 0명</span>
                        <span class="last-update" id="lastUpdate">마지막 업데이트: 방금 전</span>
                    </div>
                    
                    <div class="activity-feed" id="activityFeed">
                        <!-- 실시간 활동 로그가 여기에 동적으로 추가됩니다 -->
                    </div>
                    
                    <div class="empty-activity" id="emptyActivity">
                        <i class="fas fa-comment-slash"></i>
                        <h4>아직 활동이 없습니다</h4>
                        <p>첫 번째 포인트 거래를 시작해보세요!</p>
                    </div>
                </div>

                <div class="bank-profit-section">
                    <h3 class="section-title">
                        <i class="fas fa-university"></i> 은행 수익 현황
                    </h3>
                    <div class="profit-summary">
                        <h4>총 수익</h4>
                        <p id="totalBankProfit">0P</p>
                    </div>
                    <div class="table-container">
                        <table id="bankProfitTable">
                            <thead>
                                <tr>
                                    <th>대출 종류</th>
                                    <th>총 수익</th>
                                </tr>
                            </thead>
                            <tbody id="bankProfitTableBody">
                                <!-- 수익 내역이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                    <div class="profit-actions">
                        <button id="useProfitBtn" class="use-profit-btn"><i class="fas fa-hand-holding-usd"></i> 수익 사용</button>
                    </div>
                </div>

                <div class="bank-donor-ranking-section">
                    <h3 class="section-title">
                        <i class="fas fa-trophy"></i> 은행 기부자 랭킹
                    </h3>
                    <div class="table-container">
                        <table id="bankDonorRankingTable">
                            <thead>
                                <tr>
                                    <th>순위</th>
                                    <th>사용자</th>
                                    <th>총 기부액</th>
                                </tr>
                            </thead>
                            <tbody id="bankDonorRankingTableBody">
                                <!-- 기부자 랭킹이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="bank-spending-section">
                    <h3 class="section-title">
                        <i class="fas fa-history"></i> 은행 사용 내역
                    </h3>
                    <div class="table-container">
                        <table id="bankSpendingHistoryTable">
                            <thead>
                                <tr>
                                    <th>사용 목적</th>
                                    <th>사용 금액</th>
                                    <th>날짜</th>
                                </tr>
                            </thead>
                            <tbody id="bankSpendingHistoryBody">
                                <!-- 은행 사용 내역이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="donation-section">
                    <h3 class="section-title">
                        <i class="fas fa-hand-holding-heart"></i> 은행에 기부하기
                    </h3>
                    <div class="donation-form">
                        <div class="form-group">
                            <label for="donationAmount">기부 포인트</label>
                            <input type="number" id="donationAmount" placeholder="100P 단위로 기부" min="100" step="100">
                        </div>
                        <button id="donateBtn" class="submit-btn"><i class="fas fa-gift"></i> 기부하기</button>
                    </div>
                </div>

                <div class="donators-section">
                    <h3 class="section-title">
                        <i class="fas fa-users"></i> 기부자 목록
                    </h3>
                    <div class="table-container">
                        <table id="donatorsTable">
                            <thead>
                                <tr>
                                    <th>기부자</th>
                                    <th>기부액</th>
                                    <th>날짜</th>
                                </tr>
                            </thead>
                            <tbody id="donatorsTableBody">
                                <!-- 기부자 목록이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            </div>
    </div>

    
    
    <div id="passwordModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="modal-title">비밀번호 입력</h3>
            <p>은행 수익을 사용하려면 비밀번호를 입력하세요.</p>
            <form id="passwordForm">
                <div class="form-group">
                    <label for="passwordInput">비밀번호</label>
                    <input type="password" id="passwordInput" required>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="submit-btn">확인</button>
                    <button type="button" id="closePasswordModalBtn" class="cancel-btn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <div id="spendProfitModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="modal-title">수익 사용</h3>
            <p>사용 목적과 금액을 입력하세요.</p>
            <form id="spendProfitForm">
                <div class="form-group">
                    <label for="spendProfitReason">사용 목적</label>
                    <input type="text" id="spendProfitReason" required maxlength="100">
                </div>
                <div class="form-group">
                    <label for="spendProfitAmount">사용 포인트</label>
                    <input type="number" id="spendProfitAmount" required min="1">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="submit-btn">사용하기</button>
                    <button type="button" id="closeSpendModalBtn" class="cancel-btn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <div id="adjustPointsModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="modal-title">포인트 조정</h3>
            <p><strong id="adjustUsername"></strong> 님의 포인트를 변경합니다.</p>
            <form id="adjustPointsForm">
                <div class="form-group">
                    <label for="newPointsInput">새 포인트</label>
                    <input type="number" id="newPointsInput" required min="0">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="submit-btn">저장</button>
                    <button type="button" id="closeAdjustModalBtn" class="cancel-btn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <div id="priceItemModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="modal-title" id="priceItemModalTitle">물품 추가</h3>
            <form id="priceItemForm">
                <input type="hidden" id="priceItemId">
                <div class="form-group">
                    <label for="itemNameInput">물품 이름</label>
                    <input type="text" id="itemNameInput" required maxlength="50">
                </div>
                <div class="form-group">
                    <label for="itemPriceInput">가격</label>
                    <input type="number" id="itemPriceInput" required min="0">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="submit-btn">저장</button>
                    <button type="button" id="closePriceItemModalBtn" class="cancel-btn">취소</button>
                    <button type="button" id="deletePriceItemBtn" class="delete-btn hidden">삭제</button>
                </div>
            </form>
        </div>
    </div>

    <div id="editLoanLimitModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="modal-title">대출 한도 수정</h3>
            <p><strong id="loanLimitUsername"></strong> 님의 대출 한도를 변경합니다.</p>
            <form id="editLoanLimitForm">
                <input type="hidden" id="loanLimitUserId">
                <div class="form-group">
                    <label for="newLoanLimitInput">새 대출 한도</label>
                    <input type="number" id="newLoanLimitInput" required min="0">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="submit-btn">저장</button>
                    <button type="button" id="closeLoanLimitModalBtn" class="cancel-btn">취소</button>
                </div>
            </form>
        </div>
    </div>
    
    <script type="module" src="script.js"></script>
</body>
</html>